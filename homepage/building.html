<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="main.css" type="text/css">

<title>wxHaskell - Building</title>
<style type="text/css">
.menu-building { font-weight: bold }
.notes { margin-top: 0pt }
.notes pre { margin-top: 0.5ex; margin-bottom: 0pt }
</style>
</head>

<body>
<div id="body">

<div class="menu">
  <ul>
  <li><a class="menu-index" href="index.html">home</a></li>
  <li><a class="menu-screenshots" href="screenshots.html">screenshots</a>
      <ul>
      <li><a class="menu-samples" href="samples.html">samples</a></li>
      <li><a class="menu-applications" href="applications.html">applications</a></li>
      </ul>
  </li>
  <li><a class="menu-documentation" href="http://haskell.org/haskellwiki/WxHaskell/Documentation">documentation</a>
          <ul>
          <li><a class="menu-documentation-license" href="http://haskell.org/haskellwiki/WxHaskell/License">license</a></li>
          <li><a class="menu-documentation-quickstart" href="http://haskell.org/haskellwiki/WxHaskell/Quickstart">quick start</a></li>
          <li><a class="menu-documentation-faq" href="http://haskell.org/haskellwiki/WxHaskell/FAQ">faq</a></li>
          </ul>
  </li>
  <li><a class="menu-download" href="http://haskell.org/haskellwiki/WxHaskell/Download">download</a></li>
  </ul>
</div>
<div class="menu">
  <ul>
  <li><a class="menu-building" href="http://haskell.org/haskellwiki/WxHaskell/Building">building</a>
          <ul>
          <li><a class="menu-building-cygwin" href="http://haskell.org/haskellwiki/WxHaskell/Building_on_Cygwin">cygwin</a></li>
          <li><a class="menu-building-msc" href="http://haskell.org/haskellwiki/WxHaskell/Building_on_Windows">msc</a></li>
          <li><a class="menu-building-macosx" href="http://haskell.org/haskellwiki/WxHaskell/Building_on_MacOS_X">macosx</a></li>
          </ul>
  </li>
  <li><a class="menu-development" href="http://haskell.org/haskellwiki/WxHaskell/Development">development</a></li>
  <li><a class="menu-contribute" href="http://haskell.org/haskellwiki/WxHaskell/Contribute">contribute</a></li>
<!-- <li><a class="menu-dev-download" href="dev-download.html">download</a></li> -->
  </ul>
</div>



<div class="text">
<h2>Building from sources</h2>
<p>In principle we recommend the use of <a href="http://haskell.org/haskellwiki/WxHaskell/Download">binary releases</a>, but
wxHaskell also has a build system to compile directly from sources. The build process has
been specialized for three main platforms:</p>
<ul>
<li><b>unix-gtk</b>. General unix systems with GTK.</li>
<li><b>macosx</b>. Mac OS X.</li>
<li><b>windows</b>. General windows systems (i.e. win95 to winXP). We support both building with
        the Microsoft Visual C++ compiler version 6, 7 and 8 (<b>windows-msc</b>) and building with the
        gnu mingw32 C compiler (<b>windows-mingw</b>).</li>
</ul>

<p>wxHaskell has been build successfully on (at least) the following configurations:</p>
<ul>
<li><b>windows</b>. Windows 98, windows 2000, and windowsXP, using wxMSW 2.4.x, 2.5.x, and 2.6.x.</li>
<li><b>macosx</b>. Mac OS X 10.2 (Jaguar) and 10.3 (Panther) with ghc 6.2.x and wxMAC 2.4.2 and 2.5.x.</li>
<li><b>unix-gtk</b>. Red Hat Linux 10 (Fedora), FreeBSD, and Gentoo Linux, using wxGTK 2.4.2, 2.5.x, and 2.6.x.</li>
</ul>

<p>(Unfortunately, there are still build problems on Sun Solaris &ndash; we are looking for build volunteers :-)</p>
</div>

<div class="text">
<h2>Prerequisites</h2>

<p>Ensure you have a recent <a href="http://www.haskell.org/ghc">GHC</a> compiler &ndash; version 6.8.1 is recommended (but any version &gt;= 5.04.3 will work). In principle, any Haskell98 compiler that supports the standard FFI libraries will also work.</p>

<ul class="notes">
<li><b>windows</b>: you need the cygwin environment together
with the mingw compiler. The build process is very sensitive to the
cygwin setup and there is a separate <a href="http://haskell.org/haskellwiki/WxHaskell/Building_on_Cygwin">guide</a> for installing cygwin properly.
</li>

<li><b>macosx</b>: you need to install the <code>gcc</code> compiler, which is part of the Apple
Developer Tools. These tools are shipped with Panther and are installed by invoking <code>Applications/Installers/Developer Tools/Developer.mdmg</code>.
</li>

<li><b>ghci</b>: the GHCi interpreter only works with wxWidgets version <b>2.4.2</b> on Windows platforms.
</li>
</ul>


<p>Next, you should install the previous stable version (2.6.4) of <a href="http://www.wxwidgets.org">wxWidgets</a>
for your platform. (wxHaskell doesn't support latest stable version (currently 2.8.4) now.) We assume in this guide that the variable <code>$wxwin</code> points to your
wxWidgets installation directory, for example: <code>~/dev/wxGTK-2.6.4</code>.</p>

<ul class="notes">
<li><b>windows</b>: ghci only works with wxWidgets 2.4.2. Since this wxWidgets version is very stable, it is recommended on windows platforms.
</li>

<li><b>macosx</b>: MacOS X works best with wxWidgets 2.5.4. The previous stable release (wxMAC-2.6.4) does not display menus properly.
</li>
</ul>


<p>If you have a <a href="http://haskell.org/haskellwiki/WxHaskell/Download">source release</a> of wxHaskell,
just unpack it in a suitable directory. In the
following descriptions, we assume that the variable <code>$wxhaskell</code> points to your
installation directory, for example: <code>~/dev/wxhaskell</code>.
</p>

<p>(Note: GHC 6.6.x or higher can't build old source releases. So you must get source from darcs by below command.)</p>

<p>If you do not have a source release of wxHaskell, you need to check it out from the <a href="http://darcs.haskell.org/wxhaskell/">darcs repository</a>. Darcs creates a
<code>wxhaskell</code> directory for you; we assume in the following example that
your <code>$wxhaskell</code> directory will be <code>~/dev/wxhaskell</code>.</p>
<pre>
&gt; cd ~/dev
&gt; darcs get --partial --set-scripts-executable http://darcs.haskell.org/wxhaskell/
</pre>
<!--
<p>You can check out a specific release version using the <code>--tag</code> flag:</p>
<pre>
&gt; darcs get --tag "" http://darcs.haskell.org/wxhaskell/
</pre>
-->
</div>

<div class="text">
<h2>Building wxWidgets</h2>
<p><b>windows-msc</b>: this section describes how to build wxWidgets
using standard gnu tools -- there is a separate <a href="http://haskell.org/haskellwiki/WxHaskell/Building_on_Windows">section</a> on
building the library with Microsoft Visual C++ on windows.</p>

<p>According to the wxWidgets preferred installation, create a <code>mybuild</code> directory in the
wxWidgets directory, and run <code>configure</code> and <code>make</code> from that directory (and take the time to get some coffee :-).
</p>
<pre>&gt; cd $wxwin
&gt; mkdir mybuild
&gt; cd mybuild
&gt; ../configure --enable-unicode
&gt; make
&gt; make install
&gt; cd contrib/src
&gt; make
&gt; make install
</pre>

Notes:
<ul class="notes">
<li>Add the following flags to <code>configure</code>, to enable certain advanced features of wxHaskell:
<ul><li><code>--enable-unicode</code> to build a unicode library (required for 0.10 and up).</li>
    <li><code>--with-odbc</code> to enable <a href="http://wxhaskell.sourceforge.net/doc/Graphics.UI.WXCore.Db.html">database access</a>.</li>
    <li><code>--with-opengl</code> to enable the <a href="http://wxhaskell.sourceforge.net/doc/Graphics.UI.WXCore.OpenGL.html">openGL canvas</a>.</li>
    <li><code>--enable-sound</code> to enable playback of wave audio files. (<code>--enable-wave</code> on
    wxWidgets 2.4.x. And this option is diffrent with below option. You can play sound without no-control by this feature.
    But ... if you use below media control, it requires to make Control on your Window.)</li>
    <li><code>--enable-mediactrl</code> to enable the media control. (recommended for wxWidgets version >= 2.6.x)</li>
</ul>
</li>
<li>Do not forget to run <code>make install</code>; this installs a utility called
<code>wx-config</code> that is used by the other projects.</li>
<li>Do not forget to install 'contib' hierarchy libraries. Now latest darcs' source depends on
'contib' hierarchy libraries.</li>
<li><b>unix-gtk</b>: if you want to use the GTK-<b>2</b> toolkit, you need to configure with
unicode support since current wxHaskell can handle only unicode library. Try for example:
<pre>
../configure --with-gtk --enable-gtk2 --enable-unicode
</pre></li>
<li><b>macosx</b>: you might need to run <code>rehash</code> after <code>make install</code>
in order to add the <code>wx-config</code> utility to the search path cache.</li>
<li><b>windows</b>: sometimes the header file <code>$wxwin\include\wx\msw\popupwin.h</code>
is not properly copied when <code>make install</code> is run, and you need to
copy it manually to the install directory (for example <code>/usr/local/include/wx/msw</code>).
(if this file is not copied, C compilation of wxHaskell will fail).
</li>
</ul>

<p>Now try out a few samples of wxWidgets to see if it all works correctly:</p>
<pre>
&gt; cd ../../samples/controls
&gt; make
&gt; ./controls
</pre>

<p>Note that you build from the local <code>samples</code> directory that resides
in the <code>mybuild</code> directory.</p>

<p>And also try if <code>wx-config</code> works too:</p>
<pre>
&gt; wx-config --version
</pre>

</div>

<div class="text">
<h2>Building wxHaskell</h2>

<p>First, we configure the library for your platform.</p>

<pre>
&gt; cd $wxhaskell
&gt; ./configure --enable-split-objs --hcprof
</pre>

Notes:
<ul class="notes">
<li>You can run <code>configure</code> first with the <code>--help</code> option. This also shows the values of command-line options and is an excellent check to see
if everything is set up correctly. If the settings do not make sense, it might be that the <code>wx-config</code>
utility is not found &ndash; maybe you have forgotten to run <code>make install</code> on wxWindows?</li>
<li>You should pass the <code>--with-opengl</code> option to <code>configure</code> if you specified this
flag when configuring wxWidgets (or you will get link errors).</li>
<li>You should pass the <code>--with-contrib</code> option to <code>configure</code> if you also installed contrib libraries after building
wxWidgets (or you will get link errors).</li>
<li>By default, the library is installed in the wxWidgets install directory. You can specify another directory with the
<code>prefix</code> option of configure: <code>./configure --prefix=/usr/local</code>. Any directory that is on your library search path will do.</li>
<li><b>windows-msc</b>. Read the <a href="http://haskell.org/haskellwiki/WxHaskell/Building_on_Windows">notes</a> on building wxHaskell with Visual C++.</li>
<li><b>ghc 6.0.1, wxhaskell 0.8</b>: In the file <code>wxcore/src/Graphics/UI/WXCore/WxcObjects.hs</code> you need to switch the parameters to <code>newForeignPtr</code> on line 172. In the file <code>wx/src/Graphics/UI/WX/Controls.hs</code> you need to replace the import of <code>Data.Typeable</code> by <code>Data.Dynamic</code>.</li>
</ul>

<p>After configuration, we build and install the libraries (and take some more time to drink more coffee :-).</p>
<pre>
&gt; make
&gt; make install
&gt; make wx
&gt; make wx-install
</pre>

Notes:
<ul class="notes">
<li>If <code>make install</code> fails when building the ghc package, you might not have administrator priviliges. Either run it as an administrator or configure in such a way that you use a <a href="http://haskell.cs.yale.edu/ghc/docs/latest/html/users_guide/packages.html">local ghc package</a>:
<pre>
./configure --package-conf=~/mypackages</pre>
</li>
<li>You can generate documentation with <code>make doc</code>.
</li>
<li>The libraries can be uninstalled with <code>make uninstall</code>.
</li>
</ul>
</div>

<div class="text">
<h2>Test wxHaskell</h2>
<p>If everything succeeded, you should be able to run a test program.</p>
<pre>
&gt; cd samples/wx
&gt; ghc -package wx -o helloworld HelloWorld.hs
&gt; ./helloworld
</pre>

<p>Notes:</p>
<ul class="notes">
<li><b>macosx</b>: Unfortunately, wxHaskell programs do not work directly as generated by
GHC. Look at the MacOS X <a href="http://haskell.org/haskellwiki/WxHaskell/Building_on_MacOS_X">notes</a> for more information.</li>
</li>
</ul>

<p>You can also run the examples from GHCi &ndash; a great development environment! </p>
<pre>
&gt; ghci -package wx BouncingBalls.hs
&gt; main
</pre>

<p>Notes:</p>
<ul class="notes">
<li>wxHaskell programs are not always properly re&iuml;nitialized when started
the second time from a GHCi prompt. This is due static variables in the wxWidgets C++ code, and
we are working with wxWidgets developers to remove those bugs. Currently, GHCi only works well
with wxWidgets 2.4.2.
<li><b>gtk</b>: Unfortunately, one can only start a wxWidgets program once with GHCi on GTK (rendering it
useless).</li>
<li><b>macosx</b>. You need to use a special command to run wxHaskell applications, see the
Mac OS X <a href="http://haskell.org/haskellwiki/WxHaskell/Building_on_MacOS_X">notes</a> from more information.</li>
</li>
</ul>

<p>Have fun!<br>
&nbsp;&nbsp;&nbsp;-- Daan Leijen.</p>
</div>

<div class="status">
<a style="float: right" href="#body">top</a>last update: "5 March 2008".
</div>

</div>
</body>
</html>
